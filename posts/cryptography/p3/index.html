<!doctype html><html lang=en itemscope itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><title>Cryptography 3: Consequences and Interpretations of Semantic Security - Daminha Blog</title>
<meta name=description content="This blog delves deeper into the meaning and consequences of semantic security, one of the foundational concepts of modern cryptography. We will begin by proving that a semantically secure encryption scheme does not allow an adversary to deduce even the smallest piece of partial information about the original message, such as its parity. Next, through the example of an Internet roulette game, the blog will illustrate how the definition of semantic security is applied to analyze the security of real-world applications. Finally, we will become acquainted with another, equivalent interpretation of semantic security—the bit-guessing game—a powerful and convenient tool commonly used in cryptographic proofs."><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","name":"Daminha Blog","url":"https:\/\/dangduongminhnhat.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Organization","name":"","url":"https:\/\/dangduongminhnhat.github.io\/"}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/dangduongminhnhat.github.io\/","name":"home"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/dangduongminhnhat.github.io\/posts\/cryptography\/p3\/","name":"Cryptography 3 consequences and interpretations of semantic security"}}]}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"Article","author":{"name":"Dang Duong Minh Nhat"},"headline":"Cryptography 3: Consequences and Interpretations of Semantic Security","description":"This blog delves deeper into the meaning and consequences of semantic security, one of the foundational concepts of modern cryptography. We will begin by proving that a semantically secure encryption scheme does not allow an adversary to deduce even the smallest piece of partial information about the original message, such as its parity. Next, through the example of an Internet roulette game, the blog will illustrate how the definition of semantic security is applied to analyze the security of real-world applications. Finally, we will become acquainted with another, equivalent interpretation of semantic security—the bit-guessing game—a powerful and convenient tool commonly used in cryptographic proofs.","inLanguage":"en","wordCount":3366,"datePublished":"2025-08-05T16:12:40\u002b07:00","dateModified":"2025-08-05T16:12:40\u002b07:00","image":"https:\/\/dangduongminhnhat.github.io\/","keywords":["Cryptography, Semantic Security, Security Reduction"],"mainEntityOfPage":"https:\/\/dangduongminhnhat.github.io\/posts\/cryptography\/p3\/","publisher":{"@type":"Organization","name":"https:\/\/dangduongminhnhat.github.io\/","logo":{"@type":"ImageObject","url":"https:\/\/dangduongminhnhat.github.io\/","height":60,"width":60}}}</script><meta property="og:title" content="Cryptography 3: Consequences and Interpretations of Semantic Security"><meta property="og:description" content="This blog delves deeper into the meaning and consequences of semantic security, one of the foundational concepts of modern cryptography. We will begin by proving that a semantically secure encryption scheme does not allow an adversary to deduce even the smallest piece of partial information about the original message, such as its parity. Next, through the example of an Internet roulette game, the blog will illustrate how the definition of semantic security is applied to analyze the security of real-world applications. Finally, we will become acquainted with another, equivalent interpretation of semantic security—the bit-guessing game—a powerful and convenient tool commonly used in cryptographic proofs."><meta property="og:url" content="https://dangduongminhnhat.github.io/posts/cryptography/p3/"><meta property="og:type" content="website"><meta property="og:site_name" content="Daminha Blog"><meta name=twitter:title content="Cryptography 3: Consequences and Interpretations of Semantic Security"><meta name=twitter:description content="This blog delves deeper into the meaning and consequences of semantic security, one of the foundational concepts of modern cryptography. We will begin by proving that a semantically secure encryption …"><meta name=twitter:card content="summary_large_image"><meta name=generator content="Hugo 0.129.0"><link rel=alternate href=https://dangduongminhnhat.github.io/index.xml type=application/rss+xml title="Daminha Blog"><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css integrity=sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI crossorigin=anonymous><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.5.0/css/all.css integrity=sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css integrity=sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu crossorigin=anonymous><link rel=stylesheet href=https://dangduongminhnhat.github.io/css/main.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800"><link rel=stylesheet href=https://dangduongminhnhat.github.io/css/syntax.css><link rel=stylesheet href=https://dangduongminhnhat.github.io/css/codeblock.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css integrity=sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css integrity=sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R crossorigin=anonymous><link rel=stylesheet href=https://dangduongminhnhat.github.io/css/theme-toggle.css><script>const savedTheme=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",savedTheme)</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-V19WW5WSEZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-V19WW5WSEZ")}</script><link rel=apple-touch-icon sizes=180x180 href=/favicon_io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon_io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon_io/favicon-16x16.png><link rel=manifest href=/favicon_io/site.webmanifest><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      processEscapes: true
    }
  });
</script><script type=text/javascript async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script><script type=text/javascript async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><meta name=google-site-verification content="ors8seNeA2TL4hvELynbBtrr4PwXapoPh2td6zTadCU"><meta name=google-site-verification content="oQJmyNtEP9HjjEcXwRno2_YPeuLd5kX3jTltynIx65s"></head><body><nav class="navbar navbar-default navbar-fixed-top navbar-custom"><div class=container-fluid><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=#main-navbar>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<a class=navbar-brand href=https://dangduongminhnhat.github.io/>Daminha Blog</a></div><div class="collapse navbar-collapse" id=main-navbar><ul class="nav navbar-nav navbar-right"><li><a title=About href=/posts/about-me/>About</a></li><li><a title=Tags href=/tags/>Tags</a></li><li><a title="Cryptography Series" href=/posts/cryptography/>Cryptography Series</a></li><li><a title=Note href=https://hackmd.io/@daminha>Note</a></li><li><a title=Blog href=/posts/blog/>Blog</a></li><li><a href=javascript:void(0); onclick=toggleTheme() style=outline:none><span class="hidden-sm hidden-md hidden-lg">Theme</span>
<span class="glyphicon glyphicon-adjust" id=themeGlyph></span></a></li></ul></div></div></nav><script>document.addEventListener("DOMContentLoaded",function(){const e=localStorage.getItem("theme")||"light";document.documentElement.setAttribute("data-theme",e),window.toggleTheme=function(){const t=document.documentElement.getAttribute("data-theme"),e=t==="dark"?"light":"dark";document.documentElement.setAttribute("data-theme",e),localStorage.setItem("theme",e)}})</script><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><header class=header-section><div class="intro-header no-img"><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=posts-heading><h1>Cryptography 3: Consequences and Interpretations of Semantic Security</h1><hr class=small></div></div></div></div></div><div class=container role=main><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><article role=main class=blog-post><p><strong>Posted on:</strong> August 5, 2025 |
<strong>Reading time:</strong> 16 minutes |
<strong>Word count:</strong> 3366 words |
<strong>Author:</strong> Dang Duong Minh Nhat</p><p>Hello everyone, and welcome back to <strong>Part 3</strong> of the <em>Cryptography Series</em>!
I highly recommend reading <a href=https://dangduongminhnhat.github.io/posts/cryptography/p2/>Part 2</a> before diving into this post.
You can also explore the rest of the series <a href=https://dangduongminhnhat.github.io/posts/cryptography/>here</a>.</p><p>In this blog, we’ll dive deeper into <strong>semantic security</strong>, exploring examples and its implications.
Alright, let’s get started!</p><hr><h2 id=computing-individual-bits-of-a-message><strong>Computing individual bits of a message</strong></h2><p>If a cryptosystem is secure, it should be difficult not only to recover the entire message but also to compute any partial information about it.</p><p>Here, we will not prove a fully general theorem, but instead, consider a specific example. Let $\mathcal{E} = (E, D)$ be an encryption scheme defined over $(\mathcal{K}, \mathcal{M}, \mathcal{C})$, where $\mathcal{M} = \left\lbrace0, 1\right\rbrace^L$. For a message $m \in \mathcal{M}$, we define $\mathsf{parity}(m)$ to be $1$ if the number of $1$s in $m$ is odd, and $0$ if it is even. In other words, $\mathsf{parity}(m)$ is the XOR sum of all the bits in $m$.</p><p>We will show that if $\mathcal{E}$ is <em>semantically secure</em>, then given the ciphertext $c$ of a random message $m$, it is difficult to predict $\mathsf{parity}(m)$. Since $\mathsf{parity}(m)$ is a single bit, any adversary can predict its value correctly with a probability of $1/2$ by random guessing. But what we want to show is that no efficient adversary can do significantly better than random guessing.</p><p>Using a similar proof method as in the <a href=https://dangduongminhnhat.github.io/posts/cryptography/p2/>Cryptography 2</a> post, let&rsquo;s assume there is an efficient adversary $\mathcal{A}$ that can predict $\mathsf{parity}(m)$ with probability $1$. This means that for every message $m$, every key $k$, and every ciphertext $c$ of $m$, when we give $c$ to $\mathcal{A}$, it outputs the value $\mathsf{parity}(m)$. We can then use $\mathcal{A}$ to construct a semantic security ($\mathtt{SS}$) adversary $\mathcal{B}$ that works as follows: The adversary $\mathcal{B}$ chooses two messages $m_0$ and $m_1$ arbitrarily, but such that $\mathsf{parity}(m_0) = 0$ and $\mathsf{parity}(m_1) = 1$. It then sends these two messages to its challenger in its $\mathtt{SS}$ game, receives a ciphertext $c$, and forwards $c$ to $\mathcal{A}$. Upon receiving $c$, adversary $\mathcal{A}$ outputs a bit $\hat{b}$, and $\mathcal{B}$ outputs this same bit. It is easy to see that the $\mathtt{SS}$ advantage of $\mathcal{B}$ is exactly $1$: when the challenger encrypts $m_0$, $\mathcal{B}$ always outputs $0$, and when it encrypts $m_1$, $\mathcal{B}$ always outputs $1$. This leads to a contradiction because $\mathcal{E}$ is semantically secure. Therefore, if $\mathcal{E}$ is semantically secure, no efficient adversary can predict $\mathsf{parity}$ with probability $1$. However, we can say something stronger: if $\mathcal{E}$ is semantically secure, no efficient adversary can predict $\mathsf{parity}$ with a probability significantly greater than $1/2$. To state this precisely, we define an attack game:</p><hr><h3 id=the-parity-prediction-attack-game><strong>The Parity Prediction Attack Game</strong></h3><p>For an encryption scheme $\mathcal{E} = (E, D)$ defined on $(\mathcal{K}, \mathcal{M}, \mathcal{C})$, and a given adversary $\mathcal{A}$, the attack game proceeds as follows:</p><ul><li>The challenger chooses $m \xleftarrow{R} \mathcal{M},\ k \xleftarrow{R} \mathcal{K},\ c \leftarrow E(k, m)$ and sends $c$ to the adversary.</li><li>The adversary outputs a bit $\hat{b} \in \left\lbrace0, 1\right\rbrace$.</li></ul><p>Let $W$ be the event that $\hat{b} = \mathsf{parity}(m)$. We define the parity prediction advantage of $\mathcal{A}$ against $\mathcal{E}$ as:</p><p>$$
\mathtt{Parity}\text{adv}[\mathcal{A},\mathcal{E}] := \left| \Pr[W] - \frac{1}{2} \right|.
$$</p><hr><h3 id=definition-parity-prediction-security><strong>Definition (Parity Prediction Security)</strong></h3><p>An encryption scheme $\mathcal{E}$ is called <em>secure against parity prediction</em> if for every efficient adversary $\mathcal{A}$, the value $\mathtt{Parity}\text{adv}[\mathcal{A},\mathcal{E}]$ is <em>negligible</em>.</p><hr><p><strong>Theorem 1.</strong> Let $\mathcal{E} = (E, D)$ be an encryption scheme defined over $(\mathcal{K}, \mathcal{M}, \mathcal{C})$ with $\mathcal{M} = \left\lbrace0, 1\right\rbrace^L$. If $\mathcal{E}$ is semantically secure, then $\mathcal{E}$ is also secure against parity prediction.</p><p><strong>Proof.</strong> Similar to the proof of Theorem 1 in the <a href=https://dangduongminhnhat.github.io/posts/cryptography/p2/>Cryptography 2</a> post, we prove by <em>security reduction</em>. Specifically, we will show that for every parity-predicting adversary $\mathcal{A}$ attacking $\mathcal{E}$ in the Parity Prediction Attack Game, there exists an $\mathtt{SS}$ adversary $\mathcal{B}$ attacking $\mathcal{E}$ in the Semantic Security Attack Game from <a href=https://dangduongminhnhat.github.io/posts/cryptography/p2/>Cryptography 2</a>, where $\mathcal{B}$ is simply a &ldquo;wrapper&rdquo; around $\mathcal{A}$, such that:</p><p>$$
\mathtt{SS} \text{adv}[\mathcal{B},\mathcal{E}] = 2 \cdot \mathtt{Parity}\text{adv}[\mathcal{A},\mathcal{E}].
$$</p><p>Assume $\mathcal{A}$ is an adversary that can predict parity with probability $1/2 + \varepsilon$, i.e.:</p><p>$$
\mathtt{Parity}\text{adv}[\mathcal{A},\mathcal{E}] = |\varepsilon|.
$$</p><p>Here is how we construct the $\mathtt{SS}$ adversary $\mathcal{B}$:</p><ul><li><p>$\mathcal{B}$ generates a random message $m_0$, and sets $m_1 \leftarrow m_0 \oplus (0^{L-1} || 1)$, which means $m_1$ is identical to $m_0$ except for the last bit, which is flipped. Thus, $m_0$ and $m_1$ have opposite parities.</p></li><li><p>$\mathcal{B}$ sends the pair $(m_0, m_1)$ to its $\mathtt{SS}$ challenger, receives a ciphertext $c$ from the challenger, and forwards $c$ to $\mathcal{A}$.</p></li><li><p>When $\mathcal{A}$ outputs a bit $\hat{b}$, $\mathcal{B}$ will output $1$ if $\hat{b} = \mathsf{parity}(m_1)$, and $0$ otherwise. <em>Correction from original text for a standard reduction: B should guess which message was encrypted. Let&rsquo;s adjust slightly for clarity. B outputs 1 if $\hat{b} == \mathsf{parity}(m_1)$ and 0 if $\hat{b} == \mathsf{parity}(m_0)$ (assuming they are different). A more standard reduction is: B outputs 0 if $\hat{b} = \mathsf{parity}(m_0)$ and 1 if $\hat{b} = \mathsf{parity}(m_1)$. Let&rsquo;s follow a clear reduction:</em> When $\mathcal{A}$ outputs $\hat{b}$, $\mathcal{B}$ guesses that $m_0$ was encrypted if $\hat{b} = \mathsf{parity}(m_0)$, and that $m_1$ was encrypted if $\hat{b} = \mathsf{parity}(m_1)$. Let&rsquo;s say $\mathcal{B}$ outputs $b&rsquo;$ where $b&rsquo;=0$ if $\hat{b} = \mathsf{parity}(m_0)$ and $b&rsquo;=1$ otherwise.</p></li></ul><p>Let $p_b$ be the probability that $\mathcal{B}$ outputs $1$ if the $\mathtt{SS}$ challenger encrypts $m_b$, for $b = 0, 1$. By definition:</p><p>$$
\mathtt{SS} \text{adv}[\mathcal{B},\mathcal{E}] = |p_1 - p_0|.
$$</p><p>Let&rsquo;s analyze the probabilities. The distribution of the challenge ciphertext $c$ given to $\mathcal{A}$ is identical to the distribution in the parity-prediction game. So, $\mathcal{A}$ outputs the correct parity with probability $1/2 + \varepsilon$.</p><ul><li>If the challenger encrypted $m_0$ (so the true bit is $b=0$), $\mathcal{A}$ outputs $\mathsf{parity}(m_0)$ with probability $1/2 + \varepsilon$. In this case, $\mathcal{B}$ outputs $0$. $\mathcal{A}$ outputs $\mathsf{parity}(m_1)$ with probability $1/2 - \varepsilon$. In this case, $\mathcal{B}$ outputs $1$. So, $p_0 = \Pr[\mathcal{B} \text{ outputs } 1 \mid b=0] = 1/2 - \varepsilon$.</li><li>If the challenger encrypted $m_1$ (so the true bit is $b=1$), $\mathcal{A}$ outputs $\mathsf{parity}(m_1)$ with probability $1/2 + \varepsilon$. In this case, $\mathcal{B}$ outputs $1$. So, $p_1 = \Pr[\mathcal{B} \text{ outputs } 1 \mid b=1] = 1/2 + \varepsilon$.</li></ul><p>Therefore:</p><p>$$
\mathtt{SS} \text{adv}[\mathcal{B},\mathcal{E}] = |p_1 - p_0| = |(1/2 + \varepsilon) - (1/2 - \varepsilon)| = |2\varepsilon| = 2 \cdot \mathtt{Parity}\text{adv}[\mathcal{A},\mathcal{E}],
$$</p><p>which proves the theorem. □</p><p>Thus, we have shown that if an adversary can efficiently predict the parity of a message, then that adversary can be used to break semantic security. Conversely, if an adversary can break semantic security, then it can also efficiently predict some predicate of the message (the reader can attempt to prove the reverse direction as an exercise).</p><hr><h2 id=consequences-of-semantic-security><strong>Consequences of Semantic Security</strong></h2><p>Next, we will examine the consequences of <strong>semantic security</strong> in the context of a specific example: an electronic betting game. The specific details of the example are not overly important, but this example illustrates how the assumption of semantic security is often used in practical applications.</p><p>Consider a <strong>highly simplified</strong> version of roulette, a game between a house and a player. The player gives the house $1. He can place one of two types of bets:</p><ul><li>&ldquo;high or low&rdquo;, or</li><li>&ldquo;even or odd&rdquo;.</li></ul><p>After the bet is placed, the house chooses a random number $r \in \left\lbrace0, 1, \ldots, 36\right\rbrace$. The player wins if $r \ne 0$, and if:</p><ul><li>he bets &ldquo;high&rdquo; and $r > 18$,</li><li>he bets &ldquo;low&rdquo; and $r \le 18$,</li><li>he bets &ldquo;even&rdquo; and $r$ is even,</li><li>he bets &ldquo;odd&rdquo; and $r$ is odd.</li></ul><p>If the player wins, the house pays him 2 dollars (a net profit of 1 dollar); if he loses, the house pays nothing (a net loss of 1 dollar). Clearly, the house has a small but non-negligible advantage in this game: the probability of the player winning is $\frac{18}{37} \approx 48.65%$.</p><hr><p>Now, suppose this game is played over the Internet. And suppose for technical reasons, the house <strong>publishes an encryption of $r$ before the player places a bet</strong> (perhaps so that a regulatory agency, which shares a key with the house, can decrypt it). The player is free to analyze this encryption before placing his bet — and of course, by doing so, the player might increase his probability of winning.</p><p>However, if the encryption scheme used is good enough, the player&rsquo;s winning chances <strong>should not increase significantly</strong>. Let&rsquo;s prove this, assuming that $r$ is encrypted using a <strong>semantically secure</strong> encryption scheme $\mathcal{E} = (E, D)$, defined over $(\mathcal{K}, \mathcal{M}, \mathcal{C})$, where $\mathcal{M} = \left\lbrace0, 1, \ldots, 36\right\rbrace$ (we will assume that all messages in $\mathcal{M}$ have the same length). From here on, we will call the player $\mathcal{A}$, to emphasize the &ldquo;adversarial&rdquo; nature of the player, and assume that $\mathcal{A}$&rsquo;s strategy is modeled by an efficient algorithm.</p><hr><p>The game is illustrated in <strong>Figure 1</strong> below. Here, $bet$ represents one of the choices &ldquo;high&rdquo;, &ldquo;low&rdquo;, &ldquo;even&rdquo;, or &ldquo;odd&rdquo;. The player $\mathcal{A}$ sends $bet$ to the house, which then evaluates the function $W(r, bet)$, returning $1$ if the bet wins with $r$, and $0$ otherwise.</p><p>Define:</p><p>$$
\mathtt{IR}\text{adv}[\mathcal{A}] := \left| \Pr[W(r, bet) = 1] - \frac{18}{37} \right|.
$$</p><p><img src=/images/cryptography/p3/Internet_roulette.png alt=image>
<em>Figure 1. Internet roulette</em></p><p>Our goal is to prove the following theorem:</p><p><strong>Theorem 2.</strong> If $\mathcal{E}$ is a semantically secure encryption scheme, then for any efficient adversary $\mathcal{A}$, the value $\mathtt{IR}\text{adv}[\mathcal{A}]$ is <strong>negligible</strong>.</p><hr><p>As in previous proofs, we will <strong>prove by reduction</strong>. More specifically, we will show that for each player $\mathcal{A}$, there exists an $\mathtt{SS}$ adversary $\mathcal{B}$, where $\mathcal{B}$ is a &ldquo;simple wrapper&rdquo; around $\mathcal{A}$, such that:</p><p>$$
\mathtt{IR}\text{adv}[\mathcal{A}] \le \mathtt{SS}\text{adv}[\mathcal{B}, \mathcal{E}]. \tag{1}
$$</p><p>Thus, if there existed an efficient player $\mathcal{A}$ with a significant advantage, we would have an efficient $\mathtt{SS}$ adversary $\mathcal{B}$ that could break the semantic security of $\mathcal{E}$ — which we are assuming is impossible. This implies that no such $\mathcal{A}$ can exist.</p><hr><p>To construct and analyze the adversary $\mathcal{B}$, we consider an <strong>idealized version</strong> of the Internet roulette game, where instead of publishing an encryption of the real value $r$, the house publishes an encryption of a <strong>dummy value</strong>, for example, $0$. The logic of this idealized game is illustrated in <strong>Figure 2</strong>. Note, however, that in the ideal game, the house still uses the real value $r$ to determine the outcome of the game.</p><p><img src=/images/cryptography/p3/ideal_Internet_roulette.png alt=image>
<em>Figure 2. Ideal Internet roulette</em></p><p>Let $p_{real}$ be the probability that player $\mathcal{A}$ wins in the real Internet roulette, and $p_{ideal}$ be the probability that $\mathcal{A}$ wins in the idealized version of roulette.</p><hr><p>The adversary $\mathcal{B}$ is designed to participate in the <strong>Semantic Security Attack Game</strong>, such that we have:</p><ul><li>The real game corresponds to Experiment 0 (where $\mathcal{B}$ sends two messages, say $m_0=r$ and $m_1=0$, and receives an encryption of $m_0$).</li><li>The ideal game corresponds to Experiment 1 (where $\mathcal{B}$ receives an encryption of $m_1$).</li></ul><p>The logic of adversary $\mathcal{B}$ is illustrated in <strong>Figure 3</strong>. $\mathcal{B}$ runs $\mathcal{A}$ as a subroutine. In its own SS game, $\mathcal{B}$ chooses $m_0$ to be a random number $r \in \left\lbrace0, \dots, 36\right\rbrace$ and $m_1$ to be the number $0$. It sends $(m_0, m_1)$ to its challenger. It receives a ciphertext $c$ back, which is either $E(k, m_0)$ or $E(k, m_1)$. $\mathcal{B}$ then gives $c$ to $\mathcal{A}$. $\mathcal{A}$ outputs a bet. $\mathcal{B}$ then checks if this bet would have won against $m_0=r$. If it wins, $\mathcal{B}$ outputs 1; otherwise, it outputs 0.</p><p>Let $p_0 = \Pr[\mathcal{B} \text{ outputs } 1 \mid \text{challenge is } E(k, m_0)]$. This is exactly the winning probability in the real game, so $p_0 = p_{real}$.
Let $p_1 = \Pr[\mathcal{B} \text{ outputs } 1 \mid \text{challenge is } E(k, m_1)]$. This is exactly the winning probability in the ideal game, so $p_1 = p_{ideal}$.</p><p><img src=/images/cryptography/p3/The_SS_adversary_B_in_Attack_Game_in_semantic_security.png alt=image>
<em>Figure 3. The SS adversary B in the Semantic Security Attack Game</em></p><p>By the definition of semantic security advantage:</p><p>$$
\mathtt{SS}\text{adv}[\mathcal{B}, \mathcal{E}] = |p_1 - p_0| = |p_{ideal} - p_{real}|. \tag{2}
$$</p><hr><p>Now let&rsquo;s consider the probability $p_{ideal}$ that $\mathcal{A}$ wins in the idealized version of roulette. No matter how clever $\mathcal{A}$&rsquo;s strategy is, its winning probability is exactly $\frac{18}{37}$, because in the ideal version, the bet $bet$ is computed from the ciphertext $c$ — which is an encryption of the number $0$, and is therefore <strong>statistically independent</strong> of the value $r$. This means the ideal roulette is equivalent to real-life roulette where the player has no information. So, $p_{ideal} = \frac{18}{37}$.</p><p>By definition, $\mathtt{IR}\text{adv}[\mathcal{A}] = |p_{real} - \frac{18}{37}| = |p_{real} - p_{ideal}|$.</p><p>Combining this with (2), we get:</p><p>$$
\mathtt{IR}\text{adv}[\mathcal{A}] = |p_{real} - p_{ideal}| = \mathtt{SS}\text{adv}[\mathcal{B}, \mathcal{E}].
$$</p><p>This proves the desired relation. □</p><hr><h3 id=conclusion><strong>Conclusion</strong></h3><p>The method we used to analyze the Internet roulette game is an approach we will encounter many times in security analysis. The core idea is to <strong>replace a component in the system with an idealized version</strong> of that component, and then analyze the behavior of the new, idealized system. This is often called the <strong>real/ideal world paradigm</strong>.</p><p>Another lesson from the above example is that when reasoning about the security of a system, what we consider to be the &ldquo;adversary&rdquo; <strong>depends on the goal of the analysis</strong>. In the analysis above, we assembled a new adversary $\mathcal{B}$ from multiple components: part was the original adversary $\mathcal{A}$, and the rest was extracted from other components of the system (e.g., the house&rsquo;s algorithm). This is <strong>very typical</strong> in security analyses.</p><p>Intuitively, if one imagines a system diagram, at different points in the analysis, one will draw a &ldquo;circle&rdquo; around different components to define &ldquo;who the adversary is&rdquo; at that moment.</p><hr><h2 id=bit-guessing-an-alternative-view-of-semantic-security><strong>Bit Guessing: An Alternative View of Semantic Security</strong></h2><p>The example above is a typical case of how one can use the definition of <strong>semantic security</strong> to analyze the security properties of a larger system that uses a semantically secure encryption scheme.</p><p>However, there is another interpretation of semantic security that is often <strong>more convenient</strong> when we want to prove that a specific encryption scheme satisfies this definition. In this alternative interpretation, we define a <strong>new attack game</strong>. The adversary&rsquo;s role remains the same, but instead of having two different experiments, there is now <strong>only a single experiment</strong>.</p><p>In the <strong>bit-guessing version</strong> of the attack game, the challenger randomly chooses $b \in \left\lbrace0, 1\right\rbrace$ and executes Experiment $b$ of the <strong>Semantic Security Attack Game</strong>. The adversary&rsquo;s goal is to <strong>guess the bit $b$ correctly with a probability significantly better than 1/2</strong>.</p><hr><h3 id=the-semantic-security-attack-game-bit-guessing-version><strong>The Semantic Security Attack Game (Bit-Guessing Version)</strong></h3><p>For an encryption scheme $\mathcal{E} = (E, D)$ defined over $(\mathcal{K}, \mathcal{M}, \mathcal{C})$, and a given adversary $\mathcal{A}$, the game proceeds as follows:</p><ul><li>The adversary chooses and sends two messages $m_0, m_1 \in \mathcal{M}$ of the same length to the challenger.</li><li>The challenger randomly chooses $b \xleftarrow{R} \left\lbrace0, 1\right\rbrace$, $k \xleftarrow{R} \mathcal{K}$, computes $c \leftarrow E(k, m_b)$, and sends $c$ to the adversary.</li><li>The adversary outputs a bit $\hat{b} \in \left\lbrace0, 1\right\rbrace$.</li></ul><p>We say that the adversary <strong>wins the game</strong> if $\hat{b} = b$. □</p><hr><p><strong>Figure 4</strong> illustrates the above Attack Game. Note that in this game, the event &ldquo;adversary wins&rdquo; is defined over the probability space induced by the random choice of $b$ and $k$, as well as any random choices made by the encryption algorithm and the adversary.</p><p><img src=/images/cryptography/p3/Bit-Guessing_Version.png alt=image>
<em>Figure 4. The Semantic Security Attack Game (Bit-Guessing Version)</em></p><hr><p>Of course, any adversary can win the game with probability $1/2$ by <strong>completely ignoring $c$ and guessing randomly</strong> (e.g., always guessing $\hat{b} = 0$ or always guessing $\hat{b} = 1$). What we are interested in is <strong>how much better than random guessing</strong> the adversary can do.</p><p>If $W$ is the event that the adversary wins the bit-guessing game, then the quantity we are interested in is $|\Pr[W] - 1/2|$, denoted by $\mathtt{SS}\text{adv}^*[\mathcal{A}, \mathcal{E}]$. We then have:</p><p><strong>Theorem 3.</strong> For any encryption scheme $\mathcal{E}$ and any adversary $\mathcal{A}$, we have:</p><p>$$
\mathtt{SS}\text{adv}[\mathcal{A}, \mathcal{E}] = 2 \cdot \mathtt{SS}\text{adv}^*[\mathcal{A}, \mathcal{E}]. \tag{4}
$$</p><p><strong>Proof.</strong> This is a straightforward calculation. Let $p_0$ be the probability that the adversary outputs $1$ in <strong>Experiment 0</strong> of the original Semantic Security Attack Game, and let $p_1$ be the probability that the adversary outputs $1$ in <strong>Experiment 1</strong>.</p><p>Now consider the bit-guessing version of the Semantic Security Attack Game. From here on, all events and probabilities are considered within this game.</p><p>If we <strong>condition</strong> on the event $b = 0$, then in this conditional probability space, all other random choices (of the challenger and the adversary) are distributed <strong>identically</strong> to those in Experiment 0. Therefore, if $\hat{b}$ is the adversary&rsquo;s output in the bit-guessing game, we have:</p><p>$$
\Pr[\hat{b} = 1 \mid b = 0] = p_0.
$$</p><p>Similarly:</p><p>$$
\Pr[\hat{b} = 1 \mid b = 1] = p_1.
$$</p><p>Thus:</p><p>$$
\begin{aligned}
\Pr[\hat{b} = b] &= \Pr[\hat{b} = b \land b = 0] + \Pr[\hat{b} = b \land b = 1] \\
&= \Pr[\hat{b} = b \mid b = 0] \cdot \Pr[b = 0] + \Pr[\hat{b} = b \mid b = 1] \cdot \Pr[b = 1] \\
&= \Pr[\hat{b} = 0 \mid b = 0] \cdot \frac{1}{2} + \Pr[\hat{b} = 1 \mid b = 1] \cdot \frac{1}{2} \\
&= \frac{1}{2} \left( (1 - \Pr[\hat{b} = 1 \mid b = 0]) + \Pr[\hat{b} = 1 \mid b = 1] \right) \\
&= \frac{1}{2} (1 - p_0 + p_1).
\end{aligned}
$$</p><p>Therefore:</p><p>$$
\mathtt{SS}\text{adv}^*[\mathcal{A}, \mathcal{E}] = \left| \Pr[\hat{b} = b] - \frac{1}{2} \right| = \left| \frac{1}{2} (1 - p_0 + p_1) - \frac{1}{2} \right| = \left| \frac{1}{2}(-p_0+p_1) \right| = \frac{1}{2} |p_1 - p_0| = \frac{1}{2} \cdot \mathtt{SS}\text{adv}[\mathcal{A}, \mathcal{E}].
$$</p><p>This proves the theorem. □</p><hr><p>Just as we call $\mathtt{SS}\text{adv}[\mathcal{A}, \mathcal{E}]$ the &ldquo;<strong>semantic security advantage</strong>&rdquo; of $\mathcal{A}$, we will call $\mathtt{SS}\text{adv}^*[\mathcal{A}, \mathcal{E}]$ the &ldquo;<strong>semantic-security bit-guessing advantage</strong>&rdquo; of $\mathcal{A}$.</p><hr><h3 id=a-generalization><strong>A Generalization</strong></h3><p>In fact, this situation is <strong>very general</strong>. Although we do not need it right now, for future reference, we will describe how to generalize this situation.</p><p>There will be many situations where a certain security property — let&rsquo;s call it &ldquo;$\mathtt{X}$&rdquo; — for some cryptographic system — let&rsquo;s call it &ldquo;$\mathcal{S}$&rdquo; — can be defined via an attack game consisting of <strong>two experiments</strong>, Experiment 0 and Experiment 1. In these, the <strong>adversary $\mathcal{A}$&rsquo;s protocol is the same</strong> in both experiments, but the challenger&rsquo;s protocol is different.</p><p>For $b = 0, 1$, we define $W_b$ as the event that the adversary outputs 1 in Experiment $b$, and define:</p><p>$$
\mathtt{X}\text{adv}[\mathcal{A}, \mathcal{S}] := \left| \Pr[W_0] - \Pr[W_1] \right|
$$</p><p>as the <strong>X-advantage</strong> of adversary $A$ against system $S$.</p><p>Similar to the above, we can define a &ldquo;<strong>bit-guessing</strong>&rdquo; version of the attack game, where the challenger randomly chooses $b \in \left\lbrace0, 1\right\rbrace$ and executes Experiment $b$. If $W$ is the event that the adversary&rsquo;s output equals $b$, we define:</p><p>$$
\mathtt{X}\text{adv}^*[\mathcal{A}, \mathcal{S}] := \left| \Pr[W] - \frac{1}{2} \right|
$$</p><p>as the <strong>X bit-guessing advantage</strong> of $\mathcal{A}$.</p><p>And with the exact same calculation as in the proof of Theorem 3, we obtain:</p><p>$$
\mathtt{X}\text{adv}[\mathcal{A}, \mathcal{S}] = 2 \cdot \mathtt{X}\text{adv}^*[\mathcal{A}, \mathcal{S}]. \tag{5}
$$</p><hr><p>Throughout this blog, we have delved into the rich and rigorous aspects of semantic security. There are three key lessons to take away:</p><ol><li><p><strong>Semantic security is a very strong guarantee.</strong> It means not only that an adversary cannot recover the entire message, but also that they cannot deduce <em>any</em> useful information about it. The example of being unable to predict the parity bit showed that the ciphertext is essentially a complete &ldquo;black box&rdquo; to the adversary.</p></li><li><p><strong>Theory can be applied to analyze real-world systems.</strong> By using the technique of <em>security reduction</em> and the real/ideal world paradigm, we were able to draw a rigorous conclusion that a player cannot gain a significant advantage in the Internet roulette game if the house uses a semantically secure scheme. This is a core methodology in security analysis.</p></li><li><p><strong>There are equivalent ways to view a security definition.</strong> The conversion from a distinguishing game to a bit-guessing game is not just an intellectual exercise. It provides a flexible and often easier-to-use tool for cryptographers when proving the security of new systems.</p></li></ol><p>These concepts form the solid foundation upon which we will continue to build and analyze more secure encryption schemes in the upcoming articles of this series.</p><h2 id=references>References</h2><ol><li>Dan Boneh and Victor Shoup. <em>A Graduate Course in Applied Cryptography</em>. Retrieved from <a href=https://toc.cryptobook.us/>https://toc.cryptobook.us/</a></li></ol><h2 id=connect-with-me>Connect with Me</h2><p>Connect with me on <a href=https://www.facebook.com/dangduongminhnhat/>Facebook</a>, <a href=https://www.linkedin.com/in/nhatdang1901/>LinkedIn</a>, via email at <a href=mailto:dangduongminhnhat2003@gmail.com>dangduongminhnhat2003@gmail.com</a>, <a href=https://github.com/dangduongminhnhat>GitHub</a>, or by phone at <a href=tel:+84829258815>+84 829 258 815</a>.</p><div class=blog-tags><a href=https://dangduongminhnhat.github.io/tags/cryptography/>Cryptography</a>&nbsp;
<a href=https://dangduongminhnhat.github.io/tags/semantic-security/>Semantic Security</a>&nbsp;
<a href=https://dangduongminhnhat.github.io/tags/security-reduction/>Security Reduction</a>&nbsp;</div></article><ul class="pager blog-pager"><li class=previous><a href=https://dangduongminhnhat.github.io/posts/cryptography/p2/ data-toggle=tooltip data-placement=top title="Cryptography 2: Semantic Security Prevents Message Recovery Attacks — A Security Reduction Proof">&larr; Previous Post</a></li></ul><div id=utterances-comments><script src=https://utteranc.es/client.js repo=dangduongminhnhat/dangduongminhnhat.github.io issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></div></div><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center footer-links"></ul><p class="credits copyright text-muted">&nbsp;&bull;&nbsp;&copy;
2025
&nbsp;&bull;&nbsp;
<a href=https://dangduongminhnhat.github.io/>Daminha Blog</a></p><p class="credits theme-by text-muted"><a href=https://gohugo.io>Hugo v0.129.0</a> powered &nbsp;&bull;&nbsp; Theme <a href=https://github.com/halogenica/beautifulhugo>Beautiful Hugo</a> adapted from <a href=https://deanattali.com/beautiful-jekyll/>Beautiful Jekyll</a></p></div></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js integrity=sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script src=https://code.jquery.com/jquery-3.7.0.slim.min.js integrity=sha384-w5y/xIeYixWvfM+A1cEbmHPURnvyqmVg5eVENruEdDjcyRLUSNej7512JQGspFUr crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/js/bootstrap.min.js integrity=sha384-aJ21OjlMXNL5UyIl/XNwTMqvzeRMZH2w8c5cRVpzpU8Y5bApTppSuUkhZXN0VxHd crossorigin=anonymous></script><script src=https://dangduongminhnhat.github.io/js/main.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js integrity=sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js integrity=sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q crossorigin=anonymous></script><script src=https://dangduongminhnhat.github.io/js/load-photoswipe.js></script></body></html>